---
layout:     post
title:      "GIT用法总结"
subtitle:   ""
date:       2017-03-25 17:30:00
author:     "alvy"
header-img: "img/post-bg-database.jpg"
header-mask: 0.3
catalog:    true
tags:
    - GIT
---



参考资料：

<https://github.com/geeeeeeeeek/git-recipes/wiki>

[http://www.ruanyifeng.com/blog/2015/08/git-use-process.html](http://www.ruanyifeng.com/blog/2015/08/git-use-process.html)        

##### 分支管理,工作流  

<http://www.ruanyifeng.com/blog/2012/07/git.html>  

<https://www.git-tower.com/learn/git/ebook/cn/command-line/advanced-topics/git-flow>

<https://www.ibm.com/developerworks/cn/java/j-lo-git-mange/index.html>

***

##### 准备工作

- 创建版本库。在需要版本控制的文件夹下输入此命令，才能进行版本控制    

  `git init`

- 查看版本状态    

  `git status` 

***

##### 分支

- 创建并切换到一个分支    

  `git checkout -b branch_name`

- 合并分支    

  `git merge branch_name`

- 删除分支    

  `git branch -d branch_name`

- 删除远程分支    

  `git push origin —delete <branch_name>` 

***

##### 查看

- 查看修改记录日志    

  `git log`

- 查看修改日志一条一行显示    

  `git log --pretty=oneline`  

- 日志导出

   以导出当前分支最近50条log为例

   `git log -50 > log50_latest_commits.txt`

- 查看文件修改信息

   `git diff [文件名]`  

***

##### 回退

- 版本回退到上一步    

  `git reset --hard HEAD^`

- 版本回退到前5步   

   `git reset --hard HEAD~5`

- 根据commit id来回退    

  `git reset --hard *******(id)`

******

##### 分支管理

- 批量删除分支

  <https://stackoverflow.com/questions/3670355/can-you-delete-multiple-branches-in-one-command-with-git>

  删除 3.2 3.2.1 3.2.2三个分支

  ```shell
  $ git branch -D 3.2 3.2.1 3.2.2
  ```

  更geek的方法是

  ```shell
  $ git branch -D `git branch | grep -E '^3\.2\..*'`
  ```

***

##### 如何用远程另外的分支覆盖本地分支    

本地分支名为yangle，用远程master分支覆盖此分支，保证yangle分支和远程master分支一样。在本地yangle分支下：    

````shell
>>> git fetch origin
>>> git reset --hard origin/master
# origin/master实际上是指fetch下来已经在本地的分支
````

***

##### 如何让GIT不跟踪某些文件或文件夹

- 背景：

我在micblog下`git init`创建版本库 
micblog下有两个文件夹和一个文件：`/app /venv run.py `
我用`git add`跟踪`/app` 和`run.py` 
但是我不想跟踪`/venv`，也不想用`git status`查看状态的时候显示`/env untrack` 
应该怎么办呢？

- 解决办法：

再micblog路径下新建`.gitignore`文件 
将`venv/`添加进去，保存退出 
我们用`git status`查看状态，已经不提示venv文件夹untrack了，但是现在提示.gitignore文件untrack 
还是用同样的方法，将`.gitignore`添加到`.gitignore`文件中，保存退出即可

***

##### 删除远程仓库链接和添加远程仓库链接

1. 删除

   ```shell
   $ git remote -v
   # View current remotes
   origin  https://github.com/OWNER/REPOSITORY.git (fetch)
   origin  https://github.com/OWNER/REPOSITORY.git (push)
   destination  https://github.com/FORKER/REPOSITORY.git (fetch)
   destination  https://github.com/FORKER/REPOSITORY.git (push)

   $ git remote rm destination
   # Remove remote
   $ git remote -v
   # Verify it's gone
   origin  https://github.com/OWNER/REPOSITORY.git (fetch)
   origin  https://github.com/OWNER/REPOSITORY.git (push)
   ```

2. 添加

   ```shell
   $ git remote add origin <remote_repo_url>
   ```

##### 合并提交  

[How can I merge two commits into one?](https://stackoverflow.com/questions/2563632/how-can-i-merge-two-commits-into-one)

Get back to where you started with

```shell
$ git rebase --abort
```

Say your history is

```shell
$ git log --pretty=oneline
a931ac7c808e2471b22b5bd20f0cad046b1c5d0d c
b76d157d507e819d7511132bdb5a80dd421d854f b
df239176e1a2ffac927d8b496ea00d5488481db5 a
```

That is, a was the first commit, then b, and finally c. After committing c we decide to squash b and c together:

Running `git rebase --interactive HEAD~2` gives you an editor with

```
pick b76d157 b
pick a931ac7 c
Rebase df23917..a931ac7 onto df23917
#
# Commands:
# p, pick = use commit
# r, reword = use commit, but edit the commit message
# e, edit = use commit, but stop for amending
# s, squash = use commit, but meld into previous commit
# f, fixup = like "squash", but discard this commit's log message
#
# If you remove a line here THAT COMMIT WILL BE LOST.
# However, if you remove everything, the rebase will be aborted.
#
```

Changing b's pick to squash will result in the error you saw, but if instead you squash c into b (newer into the older) by changing the text to

```
pick b76d157 b
pick a931ac7 c
```

and save-quitting your editor, you'll get another editor whose contents are

```
# This is a combination of 2 commits.
# The first commit's message is:
b
# This is the 2nd commit message:
c
```

When you save and quit, the contents of the edited file become commit message of the new combined commit:

```shell
$ git log --pretty=oneline
18fd73d3ce748f2a58d1b566c03dd9dafe0b6b4f b and c
df239176e1a2ffac927d8b496ea00d5488481db5 a
```

##### git rebase的用法

[5.1 代码合并：Merge、Rebase 的选择](https://github.com/geeeeeeeeek/git-recipes/wiki/5.1-%E4%BB%A3%E7%A0%81%E5%90%88%E5%B9%B6%EF%BC%9AMerge%E3%80%81Rebase-%E7%9A%84%E9%80%89%E6%8B%A9)  

##### 标签tag  

创建tag  `git tag tagname`

删除本地tag  `git tag -d tagname`

推送tag  `git push —tag`  

删除远程tag  `git push origin :refs/tags/tagname`