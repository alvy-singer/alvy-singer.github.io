---
layout:     post
title:      "MySQL的安装与配置（rpm）"
subtitle:   "rpm安装"
date:       2017-05-10 17:57:00
author:     "alvy"
header-img: "img/post-bg-database.jpg"
header-mask: 0.3
catalog:    true
tags:
    - database
    - MySQL
---

##### 环境

CentOS 7

##### 卸载原有MySQL

查看是否有安装过：

```
$ rpm -qa | grep -i mysql
```

依次卸载：

```
$ rpm -e --nodeps  mysql-libs-5.1.61-4.el6.x86_64
```

要将 /var/lib/mysql文件夹下的所有文件都删除干净

##### rpm安装

参考资料：

<https://my.oschina.net/wangrikui/blog/688756>

1. 下载rpm包

   访问MySQL官方源页面<https://dev.mysql.com/downloads/mysql/>

   下载压缩包，解压之后得到多个rpm包，一般只需下面三个rpm包：

   MySQL-server-5.6.36-1.el7.x86_64.rpm
   MySQL-client-5.6.36-1.el7.x86_64.rpm
   MySQL-devel-5.6.36-1.el7.x86_64.rpm

2. 安装

   ```shell
   $ rpm -ivh MySQL-server-5.6.36-1.el7.x86_64.rpm --nosignature
   $ rpm -ivh MySQL-devel-5.6.36-1.el7.x86_64.rpm --nosignature
   $ rpm -ivh MySQL-client-5.6.36-1.el7.x86_64.rpm --nosignature
   ```

   如果出现mariadb错误，则需要卸载

   ```shell
   $ rpm -e mariadb-libs-1:5.5.44-2.el7.centos.x86_64 --nodeps
   ```

##### 启动

```shell
$ service mysql start
```

> 注：启动脚本名称修改：
>
> ```shell
> $ cd /etc/rc.d/init.d/  
> $ ls
> functions  mysql  netconsole  network  README  
> $ mv mysql mysqld 
> ```
>
> 这样启动命令就变成`service mysqld start`

##### 配置

默认配置里数据和日志的路径都是在系统盘，实际工作中我们可能需要放在另外的路径下，如下面的配置文件所示：

```
[mysqld]
datadir=/mnt/data/mysql/data
socket=/mnt/data/mysql/mysql.sock

symbolic-links=0

sql_mode=NO_ENGINE_SUBSTITUTION

[mysqld_safe]
log-error=/mnt/data/mysql/log/mysqld.log
pid-file=/mnt/data/mysql/mysqld/mysqld.pid
```

我们需要在对应的路径下创建相应路径，在这里我们需要在`/mnt/data`下创建`mysql`路径，在`mysql`下创建`log,data,mysqld`等路径，还需要创建`mysqld.log`文件，并且需要把整个`/mnt/data/mysql`路径的用户组改成mysql：

```shell
$ chown -R mysql:mysql /mnt/data/mysql
```

##### 启动错误解决办法

 <http://blog.rekfan.com/articles/186.html>​

​